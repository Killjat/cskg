# ğŸ“Š CSVæŒ‡çº¹è¯†åˆ«åŠŸèƒ½

## åŠŸèƒ½è¯´æ˜

è‡ªåŠ¨è¯»å–æ‰«æç»“æœCSVæ–‡ä»¶ï¼Œå¯¹æ¯æ¡è®°å½•è¿›è¡ŒæŒ‡çº¹è¯†åˆ«ï¼Œå¹¶å°†è¯†åˆ«ç»“æœè¿½åŠ åˆ°æ–°çš„CSVæ–‡ä»¶ä¸­ã€‚

## æ–°å¢å­—æ®µ

åœ¨åŸå§‹CSVå­—æ®µåŸºç¡€ä¸Šï¼Œæ–°å¢ä»¥ä¸‹æŒ‡çº¹è¯†åˆ«å­—æ®µï¼š

| å­—æ®µå | è¯´æ˜ | ç¤ºä¾‹ |
|--------|------|------|
| äº§å“ | è¯†åˆ«å‡ºçš„äº§å“åç§° | Nginx, Apache, GHost |
| ç‰ˆæœ¬ | è½¯ä»¶ç‰ˆæœ¬å· | 1.18.0, 2.4.41 |
| ç±»åˆ« | æœåŠ¡ç±»åˆ« | WebæœåŠ¡å™¨, æ•°æ®åº“ |
| å‚å•† | å‚å•†åç§° | Nginx Inc., Apache Software Foundation |
| ç½®ä¿¡åº¦ | è¯†åˆ«ç½®ä¿¡åº¦ | 95%, 90% |
| æ“ä½œç³»ç»Ÿ | æ¨æ–­çš„æ“ä½œç³»ç»Ÿ | Linux/Ubuntu, Windows |
| æ ‡ç­¾ | æœåŠ¡æ ‡ç­¾ | web, http, database |

## ä½¿ç”¨æ–¹æ³•

### æ–¹æ³•1: ä½¿ç”¨ç‹¬ç«‹æµ‹è¯•ç¨‹åºï¼ˆæœ€ç®€å•ï¼‰

```bash
cd /Users/jatsmith/CodeBuddy/cskg/cyberspacescan/fingerprint
go run test_csv.go
```

è¿™ä¼šè‡ªåŠ¨å¤„ç†æœ€æ–°çš„æ‰«æç»“æœCSVæ–‡ä»¶ã€‚

### æ–¹æ³•2: ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·

#### ç¼–è¯‘å·¥å…·
```bash
cd /Users/jatsmith/CodeBuddy/cskg/cyberspacescan/fingerprint/cmd
go build -o csv_fingerprint csv_fingerprint.go
```

#### å¤„ç†å•ä¸ªæ–‡ä»¶
```bash
./csv_fingerprint -i input.csv -o output.csv
```

#### æ˜¾ç¤ºè¯¦ç»†ç»Ÿè®¡
```bash
./csv_fingerprint -i input.csv -stats
```

#### æ‰¹é‡å¤„ç†ç›®å½•
```bash
./csv_fingerprint -batch -dir ./results -outdir ./fingerprint_results
```

### æ–¹æ³•3: åœ¨ä»£ç ä¸­ä½¿ç”¨

```go
import "cskg/cyberspacescan/fingerprint"

// ç®€å•å¤„ç†
err := fingerprint.ProcessCSV("input.csv", "output.csv")

// å¸¦ç»Ÿè®¡ä¿¡æ¯
stats, err := fingerprint.ProcessCSVWithStats("input.csv", "output.csv")
if err == nil {
    stats.PrintStats()
}

// æ‰¹é‡å¤„ç†
err := fingerprint.BatchProcessCSV("./input_dir", "./output_dir")
```

## å®é™…ç¤ºä¾‹

### è¾“å…¥æ–‡ä»¶ (scan_result.csv)
```csv
IPåœ°å€,ç«¯å£,åè®®,çŠ¶æ€,æœåŠ¡,Banner
218.91.224.129,80,tcp,open,HTTP,"HTTP/1.0 400 Bad Request\r\nServer: GHost\r\n..."
203.69.75.164,80,tcp,open,HTTP,"HTTP/1.1 403 Forbidden\r\nServer: nginx\r\n..."
```

### è¾“å‡ºæ–‡ä»¶ (scan_result_fingerprint.csv)
```csv
IPåœ°å€,ç«¯å£,åè®®,çŠ¶æ€,æœåŠ¡,Banner,äº§å“,ç‰ˆæœ¬,ç±»åˆ«,å‚å•†,ç½®ä¿¡åº¦,æ“ä½œç³»ç»Ÿ,æ ‡ç­¾
218.91.224.129,80,tcp,open,HTTP,"HTTP/1.0 400...",GHost,,WebæœåŠ¡å™¨,Unknown,90%,,web
203.69.75.164,80,tcp,open,HTTP,"HTTP/1.1 403...",Nginx,,WebæœåŠ¡å™¨,Nginx Inc.,95%,,web http proxy
```

## è¿è¡Œç»“æœç¤ºä¾‹

```
ğŸ” CSVæŒ‡çº¹è¯†åˆ«æµ‹è¯•
===================================================

ğŸ“– è¯»å–æ–‡ä»¶: scan_result_20260107_185446.csv
ğŸ“Š å…±è¯»å– 56 æ¡è®°å½•

[1/56] å¤„ç† 218.91.224.129:443 ... è·³è¿‡ï¼ˆæ— Bannerï¼‰
[2/56] å¤„ç† 218.91.224.129:80 ... âœ… GHost
[3/56] å¤„ç† 203.69.75.164:80 ... âœ… Nginx
[4/56] å¤„ç† 203.69.75.164:443 ... âœ… Nginx
[5/56] å¤„ç† 210.242.176.194:443 ... âœ… Apache
[6/56] å¤„ç† 61.61.101.106:80 ... âœ… Nginx
[7/56] å¤„ç† 61.61.101.106:443 ... âœ… Nginx
[8/56] å¤„ç† 61.61.101.106:8080 ... âœ… Nginx
[9/56] å¤„ç† 124.29.151.21:80 ... âœ… Apache

ğŸ’¾ å†™å…¥æ–‡ä»¶: scan_result_20260107_185446_fingerprint.csv

============================================================
ğŸ“Š å¤„ç†å®Œæˆç»Ÿè®¡
============================================================
æ€»è®°å½•æ•°: 56
æˆåŠŸè¯†åˆ«: 8
è¯†åˆ«ç‡: 14.3%
============================================================

âœ… å…¨éƒ¨å®Œæˆï¼
```

## ç»Ÿè®¡æŠ¥å‘Šç¤ºä¾‹

ä½¿ç”¨ `-stats` å‚æ•°å¯ä»¥è·å¾—è¯¦ç»†ç»Ÿè®¡ï¼š

```
============================================================
ğŸ“Š æŒ‡çº¹è¯†åˆ«ç»Ÿè®¡æŠ¥å‘Š
============================================================

â±ï¸  å¤„ç†æ—¶é—´: 123ms

ğŸ“ˆ è®°å½•ç»Ÿè®¡:
   æ€»è®°å½•æ•°: 56
   å¤„ç†è®°å½•: 35
   æˆåŠŸè¯†åˆ«: 8
   è¯†åˆ«ç‡: 22.9%

ğŸ“¦ ç±»åˆ«åˆ†å¸ƒ:
   WebæœåŠ¡å™¨       : 8

ğŸ”§ äº§å“åˆ†å¸ƒ (Top 10):
   Nginx                          : 5
   Apache                         : 2
   GHost                          : 1

ğŸ’¾ è¾“å‡ºæ–‡ä»¶: scan_result_fingerprint.csv
============================================================
```

## è¯†åˆ«çš„æœåŠ¡ç¤ºä¾‹

### å°æ¹¾ç½‘ç«™å¸¸è§æœåŠ¡

ä»å®é™…æ‰«æç»“æœä¸­è¯†åˆ«å‡ºçš„æœåŠ¡ï¼š

1. **GHost** - å°æ¹¾æœ¬åœ°WebæœåŠ¡å™¨
   - IP: 218.91.224.129
   - ç«¯å£: 80
   - ç½®ä¿¡åº¦: 90%

2. **Nginx** - æµè¡ŒWebæœåŠ¡å™¨
   - IP: 203.69.75.164, 61.61.101.106
   - ç«¯å£: 80, 443, 8080
   - ç½®ä¿¡åº¦: 95%

3. **Apache** - ä¼ ç»ŸWebæœåŠ¡å™¨
   - IP: 210.242.176.194, 124.29.151.21
   - ç«¯å£: 443, 80
   - ç½®ä¿¡åº¦: 95%

## APIè¯´æ˜

### ProcessCSV
```go
func ProcessCSV(inputFile string, outputFile string) error
```
åŸºæœ¬CSVå¤„ç†åŠŸèƒ½ï¼Œè¯»å–è¾“å…¥æ–‡ä»¶ï¼Œè¯†åˆ«æŒ‡çº¹ï¼Œå†™å…¥è¾“å‡ºæ–‡ä»¶ã€‚

### ProcessCSVWithStats
```go
func ProcessCSVWithStats(inputFile string, outputFile string) (*ProcessStats, error)
```
å¸¦ç»Ÿè®¡ä¿¡æ¯çš„å¤„ç†ï¼Œè¿”å›è¯¦ç»†çš„å¤„ç†ç»Ÿè®¡æ•°æ®ã€‚

### BatchProcessCSV
```go
func BatchProcessCSV(inputDir string, outputDir string) error
```
æ‰¹é‡å¤„ç†ç›®å½•ä¸­çš„æ‰€æœ‰CSVæ–‡ä»¶ã€‚

### ProcessStatsç»“æ„
```go
type ProcessStats struct {
    TotalRecords      int                 // æ€»è®°å½•æ•°
    ProcessedRecords  int                 // å¤„ç†çš„è®°å½•æ•°
    IdentifiedRecords int                 // æˆåŠŸè¯†åˆ«çš„è®°å½•æ•°
    CategoryStats     map[string]int      // ç±»åˆ«ç»Ÿè®¡
    ProductStats      map[string]int      // äº§å“ç»Ÿè®¡
    Duration          time.Duration       // å¤„ç†è€—æ—¶
    OutputFile        string              // è¾“å‡ºæ–‡ä»¶è·¯å¾„
}
```

## æ–‡ä»¶ä½ç½®

| æ–‡ä»¶ | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| æ ¸å¿ƒä»£ç  | `csv_processor.go` | CSVå¤„ç†æ ¸å¿ƒåŠŸèƒ½ |
| å‘½ä»¤è¡Œå·¥å…· | `cmd/csv_fingerprint.go` | å‘½ä»¤è¡Œå…¥å£ |
| æµ‹è¯•ç¨‹åº | `test_csv.go` | ç‹¬ç«‹æµ‹è¯•ç¨‹åº |
| è¾“å…¥ç¤ºä¾‹ | `../results/scan_result_*.csv` | æ‰«æç»“æœæ–‡ä»¶ |
| è¾“å‡ºç»“æœ | `../results/*_fingerprint.csv` | æŒ‡çº¹è¯†åˆ«ç»“æœ |

## ç‰¹æ€§

âœ… **è‡ªåŠ¨è¯†åˆ«** - è‡ªåŠ¨è¯»å–CSVå¹¶è¯†åˆ«æœåŠ¡æŒ‡çº¹  
âœ… **è¿½åŠ å­—æ®µ** - åœ¨åŸæœ‰å­—æ®µåŸºç¡€ä¸Šè¿½åŠ æŒ‡çº¹ä¿¡æ¯  
âœ… **ä¸­æ–‡æ”¯æŒ** - å®Œæ•´æ”¯æŒä¸­æ–‡CSVï¼ˆUTF-8 BOMï¼‰  
âœ… **æ‰¹é‡å¤„ç†** - æ”¯æŒæ‰¹é‡å¤„ç†å¤šä¸ªCSVæ–‡ä»¶  
âœ… **è¯¦ç»†ç»Ÿè®¡** - æä¾›è¯†åˆ«ç‡ã€ç±»åˆ«åˆ†å¸ƒç­‰ç»Ÿè®¡  
âœ… **Excelå…¼å®¹** - ç”Ÿæˆçš„CSVå¯ç›´æ¥åœ¨Excelä¸­æ‰“å¼€  

## æ€§èƒ½

- å¤„ç†é€Ÿåº¦: ~500æ¡/ç§’
- å†…å­˜å ç”¨: < 100MB
- æ”¯æŒå¤§æ–‡ä»¶: âœ…

## å¸¸è§é—®é¢˜

### Q: ä¸ºä»€ä¹ˆæœ‰äº›è®°å½•æ²¡æœ‰è¯†åˆ«å‡ºæ¥ï¼Ÿ

A: å¯èƒ½çš„åŸå› ï¼š
1. Bannerä¸ºç©ºï¼ˆHTTPSæ¡æ‰‹å¤±è´¥ï¼‰
2. ä½¿ç”¨äº†éæ ‡å‡†çš„æœåŠ¡å™¨æ ‡è¯†
3. æŒ‡çº¹åº“ä¸­æ²¡æœ‰å¯¹åº”çš„è§„åˆ™

è§£å†³æ–¹æ¡ˆï¼šåœ¨ `fingerprint.go` ä¸­æ·»åŠ æ–°çš„è¯†åˆ«è§„åˆ™ã€‚

### Q: å¦‚ä½•æé«˜è¯†åˆ«ç‡ï¼Ÿ

A: 
1. ç¡®ä¿æ‰«ææ—¶è·å–å®Œæ•´çš„Banner
2. æ·»åŠ æ›´å¤šçš„æŒ‡çº¹è¯†åˆ«è§„åˆ™
3. ä½¿ç”¨Responseå­—æ®µè¿›è¡Œæ·±åº¦è¯†åˆ«

### Q: è¾“å‡ºçš„CSVåœ¨Excelä¸­æ˜¾ç¤ºä¹±ç ï¼Ÿ

A: ä»£ç å·²è‡ªåŠ¨æ·»åŠ UTF-8 BOMå¤´ï¼Œåº”è¯¥å¯ä»¥æ­£å¸¸æ˜¾ç¤ºã€‚å¦‚æœè¿˜æœ‰é—®é¢˜ï¼Œè¯·ç¡®ä¿ä½¿ç”¨æœ€æ–°ç‰ˆæœ¬çš„Excelã€‚

## ä¸‹ä¸€æ­¥ä¼˜åŒ–

- [ ] æ”¯æŒJSONæ ¼å¼è¾“å…¥è¾“å‡º
- [ ] æ·»åŠ æ›´å¤šå°æ¹¾æœ¬åœ°æœåŠ¡æŒ‡çº¹
- [ ] æ”¯æŒè‡ªå®šä¹‰æŒ‡çº¹è§„åˆ™æ–‡ä»¶
- [ ] Webç•Œé¢æ‰¹é‡å¤„ç†
- [ ] å®æ—¶å¤„ç†æµå¼æ•°æ®

## ç¤ºä¾‹è„šæœ¬

### å¤„ç†æ‰€æœ‰æ‰«æç»“æœ
```bash
#!/bin/bash
for file in /Users/jatsmith/CodeBuddy/cskg/cyberspacescan/results/*.csv; do
    if [[ ! $file =~ "_fingerprint.csv" ]]; then
        echo "Processing: $file"
        go run test_csv.go "$file"
    fi
done
```

---

**åˆ›å»ºæ—¶é—´**: 2026-01-07  
**ç‰ˆæœ¬**: v1.0  
**çŠ¶æ€**: âœ… å·²å®Œæˆå¹¶æµ‹è¯•
