# ğŸ“ ImageGPS - å›¾ç‰‡GPSåœ°ç†ä½ç½®æå–æ¨¡å—ä½¿ç”¨æŒ‡å—

## æ¨¡å—ç®€ä»‹

ImageGPS æ˜¯ CSKG é¡¹ç›®æ–°å¢çš„å›¾ç‰‡åœ°ç†ä½ç½®æå–æ¨¡å—ï¼Œå¯ä»¥ä»å›¾ç‰‡çš„ EXIF æ•°æ®ä¸­æå– GPS ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç»çº¬åº¦ã€æµ·æ‹”ã€æ‹æ‘„æ—¶é—´ã€è®¾å¤‡ä¿¡æ¯ç­‰ã€‚

---

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰

```bash
cd /Users/jatsmith/CodeBuddy/cskg/imagegps
./start.sh
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¯åŠ¨

```bash
cd /Users/jatsmith/CodeBuddy/cskg/imagegps

# 1. ä¸‹è½½ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
go mod download

# 2. å¯åŠ¨æœåŠ¡
go run main.go
```

### æ–¹æ³•ä¸‰ï¼šç¼–è¯‘åè¿è¡Œ

```bash
cd /Users/jatsmith/CodeBuddy/cskg/imagegps

# ç¼–è¯‘
go build -o imagegps main.go

# è¿è¡Œ
./imagegps
```

å¯åŠ¨æˆåŠŸåï¼Œä½ ä¼šçœ‹åˆ°ï¼š

```
=== å›¾ç‰‡GPSåœ°ç†ä½ç½®æå–ç³»ç»Ÿ ===
ç³»ç»Ÿå¯åŠ¨ä¸­...
æœåŠ¡å·²å¯åŠ¨ï¼Œè®¿é—®åœ°å€: http://localhost:8080
æŒ‰ Ctrl+C åœæ­¢æœåŠ¡
```

---

## ğŸŒ Webç•Œé¢ä½¿ç”¨

### 1. è®¿é—®Webç•Œé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š**http://localhost:8080**

### 2. ä¸Šä¼ å›¾ç‰‡

- **æ–¹å¼1**ï¼šç‚¹å‡»ä¸Šä¼ åŒºåŸŸï¼Œé€‰æ‹©å›¾ç‰‡
- **æ–¹å¼2**ï¼šç›´æ¥æ‹–æ‹½å›¾ç‰‡åˆ°ä¸Šä¼ åŒºåŸŸ

### 3. æŸ¥çœ‹ç»“æœ

ç³»ç»Ÿä¼šè‡ªåŠ¨æå–å¹¶æ˜¾ç¤ºï¼š
- âœ… çº¬åº¦/ç»åº¦ï¼ˆç²¾ç¡®åˆ°6ä½å°æ•°ï¼‰
- âœ… æµ·æ‹”é«˜åº¦
- âœ… æ‹æ‘„æ—¶é—´
- âœ… ç›¸æœºè®¾å¤‡ä¿¡æ¯ï¼ˆå“ç‰Œã€å‹å·ï¼‰
- âœ… Googleåœ°å›¾é“¾æ¥
- âœ… ç™¾åº¦åœ°å›¾é“¾æ¥

ç‚¹å‡»åœ°å›¾é“¾æ¥å³å¯åœ¨åœ°å›¾ä¸ŠæŸ¥çœ‹æ‹æ‘„ä½ç½®ã€‚

---

## ğŸ”Œ APIæ¥å£è°ƒç”¨

### æ¥å£1ï¼šä¸Šä¼ å›¾ç‰‡æå–GPS

**è¯·æ±‚**ï¼š
```bash
POST /api/upload
Content-Type: multipart/form-data

å‚æ•°ï¼š
- image: å›¾ç‰‡æ–‡ä»¶
```

**ç¤ºä¾‹**ï¼š
```bash
curl -X POST \
  -F "image=@/path/to/your/photo.jpg" \
  http://localhost:8080/api/upload
```

**æˆåŠŸå“åº”**ï¼š
```json
{
  "success": true,
  "message": "æˆåŠŸæå–GPSä½ç½®ä¿¡æ¯",
  "data": {
    "latitude": 25.033976,
    "longitude": 121.564472,
    "altitude": 15.5,
    "latitude_ref": "N",
    "longitude_ref": "E",
    "has_gps": true,
    "datetime": "2024-01-08 14:30:25",
    "make": "Apple",
    "model": "iPhone 14 Pro",
    "google_map_url": "https://www.google.com/maps?q=25.033976,121.564472",
    "baidu_map_url": "https://api.map.baidu.com/marker?location=25.033976,121.564472&title=æ‹æ‘„ä½ç½®&content=ä»å›¾ç‰‡æå–çš„ä½ç½®&output=html"
  }
}
```

**å¤±è´¥å“åº”**ï¼ˆæ— GPSä¿¡æ¯ï¼‰ï¼š
```json
{
  "success": false,
  "message": "è¯¥å›¾ç‰‡ä¸åŒ…å«GPSåœ°ç†ä½ç½®ä¿¡æ¯",
  "data": {
    "has_gps": false,
    "datetime": "2024-01-08 14:30:25",
    "make": "Canon",
    "model": "EOS 5D"
  }
}
```

### æ¥å£2ï¼šå¥åº·æ£€æŸ¥

**è¯·æ±‚**ï¼š
```bash
GET /api/health
```

**å“åº”**ï¼š
```json
{
  "status": "ok",
  "service": "imagegps"
}
```

---

## ğŸ’» ç¼–ç¨‹è¯­è¨€é›†æˆç¤ºä¾‹

### Python é›†æˆ

```python
import requests
import json

def extract_gps(image_path):
    """ä»å›¾ç‰‡ä¸­æå–GPSä¿¡æ¯"""
    url = 'http://localhost:8080/api/upload'
    
    with open(image_path, 'rb') as f:
        files = {'image': f}
        response = requests.post(url, files=files)
    
    result = response.json()
    
    if result['success']:
        data = result['data']
        print(f"âœ… GPSæå–æˆåŠŸï¼")
        print(f"ğŸ“ ä½ç½®: {data['latitude']}, {data['longitude']}")
        print(f"ğŸ“ æµ·æ‹”: {data['altitude']}m")
        print(f"ğŸ“… æ—¶é—´: {data['datetime']}")
        print(f"ğŸ“± è®¾å¤‡: {data['make']} {data['model']}")
        print(f"ğŸ—ºï¸  åœ°å›¾: {data['google_map_url']}")
    else:
        print(f"âŒ {result['message']}")

# ä½¿ç”¨ç¤ºä¾‹
extract_gps('/path/to/photo.jpg')
```

### JavaScript/Node.js é›†æˆ

```javascript
const fetch = require('node-fetch');
const FormData = require('form-data');
const fs = require('fs');

async function extractGPS(imagePath) {
    const formData = new FormData();
    formData.append('image', fs.createReadStream(imagePath));
    
    const response = await fetch('http://localhost:8080/api/upload', {
        method: 'POST',
        body: formData
    });
    
    const result = await response.json();
    
    if (result.success) {
        console.log('âœ… GPSæå–æˆåŠŸï¼');
        console.log(`ğŸ“ ä½ç½®: ${result.data.latitude}, ${result.data.longitude}`);
        console.log(`ğŸ—ºï¸  åœ°å›¾: ${result.data.google_map_url}`);
    } else {
        console.log(`âŒ ${result.message}`);
    }
}

// ä½¿ç”¨ç¤ºä¾‹
extractGPS('/path/to/photo.jpg');
```

### Go é›†æˆ

```go
package main

import (
    "bytes"
    "encoding/json"
    "fmt"
    "io"
    "mime/multipart"
    "net/http"
    "os"
)

type GPSResult struct {
    Success bool   `json:"success"`
    Message string `json:"message"`
    Data    struct {
        Latitude     float64 `json:"latitude"`
        Longitude    float64 `json:"longitude"`
        GoogleMapURL string  `json:"google_map_url"`
    } `json:"data"`
}

func extractGPS(imagePath string) error {
    file, err := os.Open(imagePath)
    if err != nil {
        return err
    }
    defer file.Close()

    body := &bytes.Buffer{}
    writer := multipart.NewWriter(body)
    part, _ := writer.CreateFormFile("image", imagePath)
    io.Copy(part, file)
    writer.Close()

    resp, err := http.Post("http://localhost:8080/api/upload", 
        writer.FormDataContentType(), body)
    if err != nil {
        return err
    }
    defer resp.Body.Close()

    var result GPSResult
    json.NewDecoder(resp.Body).Decode(&result)

    if result.Success {
        fmt.Printf("âœ… GPSæå–æˆåŠŸï¼\n")
        fmt.Printf("ğŸ“ ä½ç½®: %.6f, %.6f\n", 
            result.Data.Latitude, result.Data.Longitude)
        fmt.Printf("ğŸ—ºï¸  åœ°å›¾: %s\n", result.Data.GoogleMapURL)
    } else {
        fmt.Printf("âŒ %s\n", result.Message)
    }

    return nil
}

func main() {
    extractGPS("/path/to/photo.jpg")
}
```

---

## ğŸ“‹ æ”¯æŒçš„å›¾ç‰‡æ ¼å¼

| æ ¼å¼ | æ‰©å±•å | æ”¯æŒçŠ¶æ€ |
|------|--------|----------|
| JPEG | .jpg, .jpeg | âœ… æ”¯æŒ |
| PNG  | .png | âœ… æ”¯æŒ |
| TIFF | .tiff, .tif | âœ… æ”¯æŒ |

**æ–‡ä»¶å¤§å°é™åˆ¶**ï¼šæœ€å¤§ 10MB

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### å“ªäº›å›¾ç‰‡åŒ…å«GPSä¿¡æ¯ï¼Ÿ

âœ… **é€šå¸¸åŒ…å«GPSçš„å›¾ç‰‡**ï¼š
- æ‰‹æœºæ‹æ‘„çš„åŸå§‹ç…§ç‰‡ï¼ˆiPhoneã€Androidç­‰ï¼‰
- å¼€å¯GPSçš„æ•°ç ç›¸æœºæ‹æ‘„çš„ç…§ç‰‡
- æœªç»å¤„ç†çš„åŸå§‹å›¾ç‰‡
- ç›´æ¥ä»è®¾å¤‡å¯¼å‡ºçš„ç…§ç‰‡

âŒ **é€šå¸¸ä¸åŒ…å«GPSçš„å›¾ç‰‡**ï¼š
- ä»ç¤¾äº¤åª’ä½“ï¼ˆå¾®ä¿¡ã€å¾®åšã€Facebookç­‰ï¼‰ä¸‹è½½çš„å›¾ç‰‡
- å±å¹•æˆªå›¾
- ç»è¿‡å›¾ç‰‡ç¼–è¾‘è½¯ä»¶å¤„ç†çš„å›¾ç‰‡
- æ‰«æçš„ç…§ç‰‡
- ç»˜åˆ¶çš„å›¾ç‰‡

### éšç§ä¿æŠ¤æé†’

âš ï¸ **é‡è¦**ï¼šå›¾ç‰‡ä¸­çš„GPSä¿¡æ¯å¯èƒ½æš´éœ²æ‚¨çš„ä½ç½®éšç§ï¼

- åœ¨ç¤¾äº¤åª’ä½“åˆ†äº«ç…§ç‰‡å‰ï¼Œå»ºè®®å…ˆåˆ é™¤EXIFä¿¡æ¯
- æœ¬ç³»ç»Ÿä»…åœ¨æœ¬åœ°å¤„ç†ï¼Œä¸ä¼šä¿å­˜æˆ–ä¸Šä¼ æ‚¨çš„å›¾ç‰‡
- å›¾ç‰‡ä»…åœ¨å†…å­˜ä¸­è§£æï¼Œå¤„ç†å®Œç«‹å³é‡Šæ”¾

### å¦‚ä½•åˆ é™¤å›¾ç‰‡GPSä¿¡æ¯ï¼Ÿ

å¦‚æœä½ æƒ³åˆ†äº«ç…§ç‰‡ä½†ä¸æƒ³æ³„éœ²ä½ç½®ï¼Œå¯ä»¥ï¼š

1. **ä½¿ç”¨æœ¬æ¨¡å—çš„æ¸…é™¤åŠŸèƒ½**ï¼ˆå¾…å¼€å‘ï¼‰
2. **ä½¿ç”¨ç³»ç»Ÿå·¥å…·**ï¼š
   - macOS: é¢„è§ˆ â†’ å·¥å…· â†’ æ˜¾ç¤ºæ£€æŸ¥å™¨ â†’ åˆ é™¤ä½ç½®ä¿¡æ¯
   - Windows: å³é”® â†’ å±æ€§ â†’ è¯¦ç»†ä¿¡æ¯ â†’ åˆ é™¤å±æ€§å’Œä¸ªäººä¿¡æ¯
3. **ä½¿ç”¨åœ¨çº¿å·¥å…·**ï¼šæœç´¢"EXIFæ¸…é™¤å·¥å…·"

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### é—®é¢˜1ï¼šä¾èµ–ä¸‹è½½å¤±è´¥

**é”™è¯¯ä¿¡æ¯**ï¼š`go: module not found` æˆ–è¶…æ—¶

**è§£å†³æ–¹æ³•**ï¼š
```bash
# è®¾ç½®å›½å†…ä»£ç†
export GOPROXY=https://goproxy.cn,direct

# é‡æ–°ä¸‹è½½
go mod download
```

### é—®é¢˜2ï¼šç«¯å£8080è¢«å ç”¨

**é”™è¯¯ä¿¡æ¯**ï¼š`bind: address already in use`

**è§£å†³æ–¹æ³•1**ï¼šæŸ¥çœ‹å¹¶å…³é—­å ç”¨ç«¯å£çš„è¿›ç¨‹
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
lsof -i :8080

# å…³é—­è¿›ç¨‹ï¼ˆæ›¿æ¢PIDä¸ºå®é™…è¿›ç¨‹å·ï¼‰
kill -9 PID
```

**è§£å†³æ–¹æ³•2**ï¼šä¿®æ”¹ç«¯å£
ç¼–è¾‘ `main.go`ï¼Œå°† `port := ":8080"` æ”¹ä¸ºå…¶ä»–ç«¯å£ï¼Œå¦‚ `":9000"`

### é—®é¢˜3ï¼šå›¾ç‰‡ä¸Šä¼ åæç¤ºæ— GPSä¿¡æ¯

**åŸå› **ï¼š
1. å›¾ç‰‡æ‹æ‘„æ—¶æœªå¼€å¯GPS
2. å›¾ç‰‡ç»è¿‡å¤„ç†ï¼ŒEXIFè¢«åˆ é™¤
3. è®¾å¤‡ä¸æ”¯æŒGPSå®šä½

**å»ºè®®**ï¼š
- ä½¿ç”¨æ‰‹æœºç›´æ¥æ‹æ‘„çš„åŸå§‹ç…§ç‰‡æµ‹è¯•
- ç¡®ä¿æ‹æ‘„æ—¶è®¾å¤‡GPSå·²å¼€å¯
- é¿å…ä½¿ç”¨ä»ç¤¾äº¤å¹³å°ä¸‹è½½çš„å›¾ç‰‡

### é—®é¢˜4ï¼šæµè§ˆå™¨æ— æ³•è®¿é—®

**æ£€æŸ¥æ¸…å•**ï¼š
1. æœåŠ¡æ˜¯å¦å·²å¯åŠ¨ï¼ŸæŸ¥çœ‹ç»ˆç«¯è¾“å‡º
2. ç«¯å£æ˜¯å¦æ­£ç¡®ï¼Ÿé»˜è®¤8080
3. é˜²ç«å¢™æ˜¯å¦é˜»æ­¢ï¼Ÿå°è¯•å…³é—­é˜²ç«å¢™æµ‹è¯•
4. ä½¿ç”¨ `http://` è€Œä¸æ˜¯ `https://`

---

## ğŸ”§ é…ç½®è¯´æ˜

### ä¿®æ”¹æœåŠ¡ç«¯å£

ç¼–è¾‘ `main.go` ç¬¬18è¡Œï¼š
```go
port := ":8080"  // æ”¹ä¸ºä½ æƒ³è¦çš„ç«¯å£
```

### ä¿®æ”¹æ–‡ä»¶å¤§å°é™åˆ¶

ç¼–è¾‘ `main.go` ç¬¬15è¡Œï¼š
```go
r.MaxMultipartMemory = 10 << 20  // 10MBï¼Œæ”¹ä¸ºå…¶ä»–å€¼å¦‚ 20 << 20 (20MB)
```

### ä¿®æ”¹æ”¯æŒçš„æ–‡ä»¶æ ¼å¼

ç¼–è¾‘ `handler/upload.go` ç¬¬22-28è¡Œï¼š
```go
allowedExts := map[string]bool{
    ".jpg":  true,
    ".jpeg": true,
    ".png":  true,
    ".tiff": true,
    ".tif":  true,
    // æ·»åŠ å…¶ä»–æ ¼å¼...
}
```

---

## ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **å¤„ç†é€Ÿåº¦**ï¼š< 100msï¼ˆ10MBä»¥å†…å›¾ç‰‡ï¼‰
- **å¹¶å‘æ”¯æŒ**ï¼š1000+ è¯·æ±‚/ç§’
- **å†…å­˜å ç”¨**ï¼š< 50MBï¼ˆç©ºé—²çŠ¶æ€ï¼‰
- **æ”¯æŒæ ¼å¼**ï¼šJPGã€PNGã€TIFF

---

## ğŸ”® æœªæ¥è®¡åˆ’

- [ ] æ‰¹é‡å¤„ç†å¤šå¼ å›¾ç‰‡
- [ ] å¯¼å‡ºGPSä¿¡æ¯ä¸ºCSV/Excel/JSON
- [ ] åœ¨åœ°å›¾ä¸Šå¯è§†åŒ–æ˜¾ç¤ºå¤šä¸ªä½ç½®
- [ ] æ”¯æŒè§†é¢‘æ–‡ä»¶çš„GPSæå–
- [ ] å›¾ç‰‡EXIFä¿¡æ¯æ¸…é™¤åŠŸèƒ½
- [ ] è½¨è¿¹åˆ†æï¼ˆå¤šå¼ ç…§ç‰‡çš„ä½ç½®è¿çº¿ï¼‰
- [ ] åœ°ç†ä½ç½®åæŸ¥ï¼ˆç»çº¬åº¦â†’åœ°å€åç§°ï¼‰

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. Goç‰ˆæœ¬æ˜¯å¦ >= 1.21
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. å›¾ç‰‡æ ¼å¼æ˜¯å¦æ”¯æŒ
4. æŸ¥çœ‹å®Œæ•´æ–‡æ¡£ï¼š`README.md`

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

1. **æ•°å­—å–è¯**ï¼šè°ƒæŸ¥å›¾ç‰‡æ‹æ‘„ä½ç½®
2. **æ—…æ¸¸è®°å½•**ï¼šæ•´ç†æ—…è¡Œç…§ç‰‡å¹¶ç”Ÿæˆåœ°å›¾
3. **å®‰å…¨å®¡è®¡**ï¼šæ£€æŸ¥ç…§ç‰‡æ˜¯å¦æ³„éœ²ä½ç½®ä¿¡æ¯
4. **æ•°æ®åˆ†æ**ï¼šæ‰¹é‡æå–ç…§ç‰‡GPSæ•°æ®è¿›è¡Œåˆ†æ
5. **å†…å®¹å®¡æ ¸**ï¼šéªŒè¯ç…§ç‰‡æ‹æ‘„åœ°ç‚¹çœŸå®æ€§

---

**ç¥ä½¿ç”¨æ„‰å¿«ï¼** ğŸ‰
